
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>计算机网络 - 如是</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="互联网概述：
计算机网络由若干结点（节点）和连接这些节点的链路组成  12端系统：连接在互联网上的所有主机节点：计算机、集线器、交换器、路由器等端系统和中间节点
互联网服务提供商：ISP，如中国移动,"> 
    <meta name="author" content="如是"> 
    <link rel="alternative" href="atom.xml" title="如是" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.jpg"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">如是</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://example.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">计算机网络</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">计算机网络</h1>
        <div class="stuff">
            <span>四月 05, 2021</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></li></ul>


        </div>
        <div class="content markdown">
            <h3 id="互联网概述："><a href="#互联网概述：" class="headerlink" title="互联网概述："></a>互联网概述：</h3><ol>
<li>计算机网络由若干结点（节点）和连接这些节点的链路组成  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">端系统：连接在互联网上的所有主机</span><br><span class="line">节点：计算机、集线器、交换器、路由器等端系统和中间节点</span><br></pre></td></tr></table></figure></li>
<li>互联网服务提供商：ISP，如中国移动</li>
<li>互联网由边缘部分主机和核心部分路由器组成<span id="more"></span></li>
<li>电路交换：通话之前建立一条专用的物理通路，在通话的全部时间内，通话的两个用户始终占用端到端的通信资源</li>
<li>分组交换：将要发送的整块数据（报文）划分成为一个个更小的等长数据段加上首部组成分组独立选择传输路径，不占用一条端到端的链路通信资源<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">分组交换的优点：高效（动态分配传输带宽）、灵活（独立选择转发路由）、迅速（不建立连接就能发送）、可靠（生存性强）</span><br><span class="line">缺点： 分组在存储转发时需要排队造成时延；</span><br><span class="line">       不建立连接，无法保证所需的带宽；</span><br><span class="line">       添加的控制信息组成的首部造成额外开销；</span><br><span class="line">三种交换方式的特点：</span><br><span class="line">        电路交换：整个报文的比特流持续从原点到达终点（延迟最小）</span><br><span class="line">        报文交换：整个报文先传送到相邻节点，全部存储下来后查找转发表转发（延迟最大）</span><br><span class="line">        分组交换：单个分组传送到相邻节点，存储下来查找转发表转发</span><br><span class="line">选择：持续传送大量的数据且传送时间远远大于连接建立时间选择电路交换；报文交换和分组</span><br><span class="line">     交换则不需要预先分配带宽，在传送突发数据时可提高整个网络的信道利用率</span><br></pre></td></tr></table></figure></li>
<li>按网络作用范围分类：局域网（LAN）、广域网（WAN）、城域网（MAN）、个人区域网（PAN）</li>
<li>计算机网络的性能指标：<strong>速率、带宽、吞吐量、时延、时延带宽积、往返时间RTT、利用率</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">速率：数据的传送速率也称数据率</span><br><span class="line">带宽：单位时间信道能通过的最高速率</span><br><span class="line">吞吐量：单位时间通过信道的实际数据量</span><br><span class="line">时延：数据从网络的一端传送到另一端需要的时间（也叫延迟或迟延）</span><br><span class="line">时延带宽积：传播时延和带宽相乘</span><br><span class="line">往返时间：信息双向交互一次所需的时间</span><br><span class="line">利用率：信道利用率指某信道有百分之几的时间是被利用的；网络利用率是指全网络的信道利用率的加权平均值</span><br></pre></td></tr></table></figure></li>
<li>计算机网络的非性能指标：费用、质量、标准化、可靠性、可扩展性和可升级性、易于管理和维护</li>
<li>OSI：开放系统互联基本参考模型(ISO国际标准化组织)</li>
<li>网络协议三要素：<strong>语义、语法、同步</strong></li>
<li>OSI体系结构：应用层、表示层、会话层、传输层、网络层（网际层或IP层）、数据链路层、物理层<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">应用层：通过应用进程间的交互来完成特定的网络应用，应用层协议定义的是应用进程间通信和交互的规则，数据单元称为报文</span><br><span class="line">传输层：向两台主机中进程间的通信提供通用的数据传输服务，TCP数据单元是报文段，UDP是用户数据报</span><br><span class="line">网络层：负责为分组交换网上的不同主机提供通信服务，将传输层的报文段或用户数据报封装为分组（IP数据报或数据报）</span><br><span class="line">数据链路层：将IP数据报组装为帧</span><br><span class="line">物理层：传输的数据单位为比特</span><br></pre></td></tr></table></figure></li>
<li>TCP/IP体系结构：应用层、传输层、网际层、网际接口层</li>
<li>OSI把对等层次之间传送的数据单位称为该层的<strong>协议数据单元</strong>（<strong>PDU</strong>）</li>
<li>OSI把层与层之间交换的数据的单位称为<strong>服务数据单元</strong>（<strong>SDU</strong>）</li>
<li>端系统之间的通信方式：客户-服务器方式（C/S方式）、对等方式（P2P方式）<h3 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h3></li>
<li>物理层的特性：机械特性（接口的接线器的形状、尺寸、引脚数目等）、电气特性（接口电缆各线的电压范围）、功能特性（某条线电平的电压的意义）、过程特性（各种可能事件的出现顺序）</li>
<li>数据在计算机内部多采用并行运输，在通信线路上多采用串行运输（逐个比特按时间顺序传输）</li>
<li>按交互方式分类通信：单工通信、半双工通信（都可发送但不能同时发送）、全双工通信（双方可同时发送和接收）（半双工和全双工都是两条信道）</li>
<li>来自信源的信号称为<strong>基带信号</strong></li>
<li>电磁干扰 (EMI) 或射频干扰 (RFI)：EMI 和 RFI 干扰信号会扭曲和损坏通过铜介质承载的数据信号。EMI 和 RFI 的潜在来源包括无线电波和电磁设备（如荧光灯或电动机<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">为了应对 EMI 和 RFI 的负面影响，某些类型的铜缆会用金属屏蔽套包裹，并要求适当的接地连接</span><br></pre></td></tr></table></figure></li>
<li>串扰：串扰是一根电线中信号的电场或磁场对邻近电线中的信号造成的干扰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">为了应对串扰的负面影响，某些类型的铜缆将相反电路线对绞合在一起以有效消除串扰</span><br></pre></td></tr></table></figure></li>
<li>双绞线：利用绞合减少对相邻导线的电磁干扰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">适用：模拟传输和数字传输</span><br><span class="line">通信距离：几到十几公里（课本写的，网上查双绞线的最大传输距离为100m）</span><br><span class="line">分类：屏蔽双绞线STP、无屏蔽双绞线UTP</span><br><span class="line">(UTP 电缆的端头通常为 RJ-45 连接器)</span><br><span class="line">568-A标准：左起 白绿、绿、白橙、蓝、白蓝、橙、白棕、棕</span><br><span class="line">568-B标准：左起 白橙、橙、白绿、蓝、白蓝、绿、白棕、棕</span><br><span class="line">网络中的铜介质有三种主要类型：非屏蔽双绞线 (UTP)、屏蔽双绞线 (STP) 和同轴电缆。</span><br></pre></td></tr></table></figure></li>
<li>光纤通信：利用光导纤维传递光脉冲来通信<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.带宽远远大于其他各种传输媒体的带宽</span><br><span class="line">2.多模光纤：多条入射光线在一条光纤中传输</span><br><span class="line">3.单模光纤(SMF)的光源：LD（激光器）</span><br><span class="line">4.多模光纤(MMF)的光源：LED（发光二极管）</span><br><span class="line">5.多模光纤只适用于近距离传输（光脉冲在多模光纤中会逐渐变宽造成失真）</span><br></pre></td></tr></table></figure></li>
<li>宽带接入技术：ADSL技术（非对称数字用户线）、HFC网（光纤同轴混合网）、FTTH（光纤到户）</li>
<li>以太网直通电缆：最常见的网络电缆类型。它通常用于主机到交换机和交换机到路由器的互连</li>
<li>以太网交叉电缆：用于互连相似设备的电缆。例如，交换机到交换机、主机到主机或路由器到路由器的连接</li>
<li>物理拓扑：是指物理连接，用于标识终端设备和基础设施设备（如路由器、交换机和无线接入点）如何互连。</li>
<li>逻辑拓扑： 是指网络将帧从一个节点传输到另一节点的方法。</li>
</ol>
<h3 id="数据链路层："><a href="#数据链路层：" class="headerlink" title="数据链路层："></a>数据链路层：</h3><ol>
<li>链路指物理链路，数据链路指实现通信协议的软硬件加物理链路。  </li>
<li>数据链路层的三个基本问题：封装成帧、透明传输和差错检测。（透明传输：所传送的数据比特流中可以传送任意组合的比特流）  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">通用帧字段类型包括：</span><br><span class="line">帧开始和停止指示标志 - 用于标识帧的开始和结束位置的限制。</span><br><span class="line">编址 - 表示介质上的源节点和目的节点。</span><br><span class="line">类型 - 用于标识数据字段中的第 3 层协议。</span><br><span class="line">控制 - 用于标识特殊流量控制服务，比如服务质量 (QoS)。QoS 用于为某些类型的消息提供转发优先权。传送 IP 语音 (VoIP) 数据包的数据链路帧通常会获得优先权，因为它们对延迟敏感。</span><br><span class="line">数据 - 包含帧负载（即数据包报头、数据段报头和数据）。</span><br><span class="line">错误检测 - 这些帧字段用于进行错误检测并包含在数据之后形成帧尾。</span><br></pre></td></tr></table></figure></li>
<li>无差错接收：有差错丢弃，无差错接收。  </li>
<li>PPP协议是用户计算机和ISP进行通信时使用的数据链路层协议。</li>
<li>PPP协议由三部分组成：将IP数据包封装到链路的方法；链路控制协议LCP；网络控制协议NCP</li>
<li>PPP协议的帧不进行编址</li>
<li>PPP协议支持同步和异步传输，只工作在全双工链路</li>
<li>局域网工作在数据链路层和物理层</li>
<li>共享通信媒体资源的两种方法：静态划分信道；动态媒体接入控制（分随机接入和受控接入）</li>
<li>局域网的数据链路层拆分为：逻辑链路控制层LLC和介质访问控制层MAC<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MAC层的主要职责：数据封装和介质访问控制</span><br></pre></td></tr></table></figure></li>
<li>以太网采用无连接的工作方式，对数据帧不进行编号也不要求对方发回确认</li>
<li>适配器（网络接口卡NIC）：进行数据串行运输和并行运输的转换（数据在计算机内部是并行运输，在通信线路是串行运输），接收到有差错的帧直接丢弃不通知计算机</li>
<li>CSMA/CD（载波监听多点接入碰撞检测）: 边发送边监听信道，不能进行全双工通信只能进行半双工通信，只有确保信道在96比特时间空闲时才发送帧</li>
<li>传统以太网10BASE-T（10代表10Mbit/s,BASE代表信号为基带信号，T代表双绞线）工作在半双工链路。</li>
<li>快速以太网100BASE-T以太网支持全双工和半双工两种工作方式，全双工不适用CSMA/CD协议，半双工必须使用</li>
<li>吉比特以太网：支持全双工和半双工工作方式，全双工不适用CSMA/CD协议，半双工使用</li>
<li>10吉比特以太网：只工作在全双工方式，不适用CSMA/CD协议</li>
<li>MAC地址：又称硬件地址或物理地址，固化在适配器即网卡的ROM中，6个字节，前三个字节是OUI（公司标识符），后三个是EUI（扩展的唯一标识符）<code>FF-FF-FF-FF-FF-FF 广播 MAC 地址。</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">物理地址（MAC 地址）– 用于同一网络中的以太网网卡之间的通信。</span><br><span class="line">逻辑地址（IP 地址）– 用于将数据包从原始源发送到最终目的地。</span><br></pre></td></tr></table></figure></li>
<li>MAC帧：目的地址（6个字节）；源地址（6个字节）；类型（2个字节，上层协议类型）；数据（46~1500字节，封装上层数据）；FCS（4字节，帧检验序列，用于循环冗余检验CRC）（注：实际传送中帧前面还插有8个字节，包括7个字节的前同步码和1个字节的帧开始定界符，同步传输时不使用前同步码）<br><img src="https://s1.ax1x.com/2018/12/15/FarDBR.jpg" alt="image"></li>
<li>以太网交换机：工作在数据链路层（还有网桥），全双工方式工作（不使用CSMA/CD协议），连通的主机独占数据媒体，无碰撞的传输数据。通过自学习方式构建MAC交换表（路由器是自学习加和相邻路由器交换）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">交换机数据包的转发方法；</span><br><span class="line">存储转发交换：接收完整的帧，CRC检验，正确则转发，错误则由交换机丢弃</span><br><span class="line">直通交换：受到整个帧之前转发帧，至少读取帧的目的地址，不检验，目的网络适配器检验，有错误被目的网络适配器丢</span><br></pre></td></tr></table></figure></li>
<li>集线器：工作在物理层（还有转发器），接口仅简单的转发比特不进行碰撞检测</li>
<li>路由器：工作在网络层。</li>
<li>VLAN（虚拟局域网）：VLAN是由一些局域网网段构成的逻辑组，这些网段有某些共同的需求。VLAN限制了接收广播信息的计算机数，使得网络不会因为传播过多的广播信息而引起性能恶化。</li>
<li>以太网的优点：可扩展的；灵活的；易于安装；稳健性好</li>
<li>数据链路层负责事项：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 允许上层访问介质</span><br><span class="line">2. 接受第 3 层数据包，并将它们打包为帧</span><br><span class="line">3. 为物理网络准备网络数据</span><br><span class="line">4. 控制数据在介质中的放置和接收方式</span><br><span class="line">5. 在物理网络介质（例如 UTP 或光纤）中的节点之间交换帧</span><br><span class="line">6. 接收数据包并将其传输给上层协议</span><br><span class="line">7. 执行错误检测</span><br></pre></td></tr></table></figure></li>
<li>共享介质的介质访问控制方法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">争用访问: 在半双工模式下运行的所有节点争用介质，但一次只有一台设备可以发送。[载波侦听多路访问&#x2F;冲突检测 (CSMA&#x2F;CD) 和 载波侦听多路访问&#x2F;冲突避免 (CSMA&#x2F;CA)]</span><br><span class="line">受控访问: 每个节点都有各自使用介质的时间。</span><br><span class="line">默认情况下，以太网交换机在全双工模式下运行。这允许交换机和全双工连接的设备同时发送和接收。</span><br></pre></td></tr></table></figure></li>
<li>数据链路层的协议<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">以太网（以太网在数据链路层和物理层运行。以太网是 IEEE 802.2 和 802.3 标准中定义的一系列网络技术。）</span><br><span class="line">802.11 无线</span><br><span class="line">点对点协议 (PPP)</span><br><span class="line">HDLC</span><br><span class="line">帧中继</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h3><ol>
<li>网络层的主要功能：路由选择、拥塞控制、网络互连、分组转发（网络层的主要工作）</li>
<li>网络层向上只提供简单灵活的、无连接的、尽最大努力交付的数据报服务</li>
<li>网络层的协议：IP协议、ARP协议（地址解析协议）、RARP（逆地址解析协议）、ICMP（网际控制报文协议）、IGMP（网际组管理协议）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IP协议的特征：无连接、最大努力、介质无关性</span><br></pre></td></tr></table></figure></li>
<li>路由器的协议栈只有下三层协议</li>
<li><strong>IP地址编址的三个历史阶段：分类的IP地址；子网的划分；构成超网（无分类域间路由选择CIDR）</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">划分子网的原因：</span><br><span class="line">1. IP地址的空间利用率有时很低</span><br><span class="line">2. 给每一个物理网络分配一个网络号会使路由表变得太大而使网络性能变坏</span><br><span class="line">3. 两级IP地址不够灵活</span><br><span class="line"></span><br><span class="line">CIDR的原因：</span><br><span class="line">1. B类地址即将分配完毕</span><br><span class="line">2. 互联网主干网上的路由表中的项目数急剧增长</span><br><span class="line">3. 整个IPv4的地址空间最终将全部耗尽</span><br><span class="line"></span><br><span class="line">IPv4的局限性：</span><br><span class="line">1. 地址即将耗尽</span><br><span class="line">2. 路由表膨胀</span><br><span class="line">3. 缺乏端到端的连接</span><br><span class="line"></span><br><span class="line">IPv6的功能提升：</span><br><span class="line">1. 更大的地址空间</span><br><span class="line">2. 改进数据包处理过成</span><br><span class="line">3. 消除了对NAT的需求</span><br></pre></td></tr></table></figure></li>
<li>分类的IP地址：网络号+主机号组成。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. A、B、C类地址网络号字段分别占1,2,3个字节网络号前的类别位分别为0,10,110</span><br><span class="line">2. D类用于多播，前四位是1110</span><br><span class="line">3. E类前四位是1111</span><br></pre></td></tr></table></figure></li>
<li>网络号全为0的IP地址是个保留地址，意思是本网络<code>环回地址127.0.0.1</code></li>
<li>每个网络中有两个Ip地址不可用，全为0的主机号表示主机所连接到的单个网络地址，全1表示网络上的所有主机，用于广播</li>
<li>路由器仅根据目的主机所连接的网络号来转发分组，使路由表中的项目数大幅度减少，减小了路由表所占的存储空间以及查找路由表的时间</li>
<li>网络层及以上使用IP地址，数据链路层及以下使用MAC地址</li>
<li>MAC帧在经过路由器转发时会改变源MAC地址和目的MAC地址，而源IP地址和目的IP地址不变</li>
<li>ARP协议：从网络层使用的IP地址解析出在数据链路层使用的MAC地址  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ARP两个基本功能：将IPv4地址解析为MAC地址；维护映射表</span><br><span class="line">在同一网络搜索则目的IP地址，不同网络则搜索默认网关的IP地址，找到则将其作为目的MAC地址，找不到</span><br><span class="line">则发送ARP请求（ARP请求属于广播），获得响应分组，然后在ARP高速缓存（ARP表）中写入得</span><br><span class="line">到的IP地址和MAC地址的映射关系</span><br><span class="line">1. ARP表：存在主机上，是IP地址和MAC地址的映射，用于将目的MAC地址封装到MAC帧中，不存在目的MAC地址则发送ARP请求</span><br><span class="line">2. MAC表：存在交换机上，MAC地址和交换机接口的映射，用于转发MAC帧，不存在目的MAC地址则广播(向除传入端口外的其他端口发送)</span><br><span class="line">3. 路由表：存在路由器上，网络地址、子网掩码和下一跳地址（直接交付到接口或指定下一跳地址）的映射，转发分组</span><br></pre></td></tr></table></figure></li>
<li>IP数据报的格式：<br><img src="https://s1.ax1x.com/2018/12/15/FaVWZV.jpg" alt="image"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">IP数据报 &#x3D; 首部 + 数据部分</span><br><span class="line">首部 &#x3D; 固定部分（20字节） + 可变部分</span><br><span class="line"></span><br><span class="line">首部:   版本：4位，指IP协议的版本</span><br><span class="line">        首部长度：4位，最大代表十进制数值15，每个数值大小代表四个字节。因为首部固定部分长度20字节，所以最小为5，最大为15所以首部最大60字节。</span><br><span class="line">        区分服务：8位，未被使用过</span><br><span class="line">        总长度：16位，单位为字节，代表IP数据报的长度（数据链路层协议规定了帧中数据字段的最大长度，称为最大传送单元即MTU，以太网规定为1500，超过MTU值就要进分片处理，分片后首部的总长度指的是分片后首部加数据部分的长度）</span><br><span class="line">        标识：16位，每产生一个IP数据报计时器加一并赋值给标识字段，数据报分片后具有相同的标识</span><br><span class="line">        标志：3位，中位为0表示允许分片，低位为1表示后面还有分片</span><br><span class="line">        片偏移：13位，表示分片后的片关于原分组的相对位置，以8字节为偏移单位，每个分片的长度一定是8的整数倍</span><br><span class="line">        生存时间（TTL）：数据报在网络中的寿命，防止无限制兜圈，后来随着处理时间减小，而改为跳数，路由器在每次转发前将其值减一，减到0则丢弃，最大数值为255</span><br><span class="line">        协议：8位，指出数据报携带的数据使用何种协议，使IP层知道该将数据报上交给哪个协议</span><br><span class="line">        首部检验和：不是利用循环冗余检验CRC，只检验数据报的首部，不包括数据部分</span><br><span class="line">        源地址：32位，4字节</span><br><span class="line">        目的地址：32位，4字节</span><br></pre></td></tr></table></figure></li>
<li>路由器的直接交付和间接交付：从数据报的目的地址得到目的网络地址，若与路由器直接相连则直接交付，否则间接交付<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">默认网关：默认网关是可以将流量路由到其他网络的网络设备。它是将流量从本地网络路由出去的路由器。</span><br><span class="line">路由表的存储信息：直连路由、远程路由、默认路由（C表示直连网络，L表示本地接口）</span><br><span class="line">路由来源：S（静态路由），D（增强型内部网关路由协议，EIGRP），O（开放最短路径有限，OSPF）</span><br></pre></td></tr></table></figure></li>
<li><strong>划分子网：从网络的主机号借用若干位作为子网号，两级IP地址变为三级IP地址</strong></li>
<li><strong>CIDR：消除分类的IP地址和子网划分的概念，将IP地址划分为“网络前缀”部分和“主机号”部分</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 斜线记法：IP地址后加‘&#x2F;’然后写上网络前缀所占的位数</span><br><span class="line">2. 子网掩码：1的个数就是网络前缀的长度，斜线后的数字就是1的个数</span><br><span class="line">3. CIDR不使用子网但仍可以将一个地址块划分子网，子网的网络前缀长度比原地址块的前缀长度要长（课本就是这么说的，感觉还是有点矛盾）</span><br><span class="line"></span><br><span class="line">CIDR特点：</span><br><span class="line">1. 消除分类的IP地址和划分子网的概念，将IP地址划分为“网络前缀”部分和“主机号”部分，无分类的两级编址</span><br><span class="line">2. 把网络前缀都相同的连续的IP地址组成一个“CIDR地址块”</span><br></pre></td></tr></table></figure></li>
<li>路由聚合（构成超网）：将多个地址用一个CIDR地址块表示</li>
<li>最长前缀匹配：路由表在匹配网络地址进行转发时若有多个符合条件的匹配结果则选择具有最长网络前缀的路由</li>
<li>网际控制报文协议（ICMP）：允许主机或路由器报告差错情况和提供有关异常情况的报告<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ICMP报文分两种：ICMP差错报告报文和ICMP询问报文</span><br><span class="line">ICMP差错报告报文：终点不可达；时间超过；参数问题；改变路由</span><br><span class="line">                 （终点不可达分为：网络不可达、主机不可达、协议不可达、端口不可达等不可达信息）</span><br><span class="line">ICMP询问报文：  1.回送请求和回答：主机或路由器向目的主机发出询问，收到报文的主机必须向发送方ICMP会送回答报文（用于测试连通性，用于PING命令）</span><br><span class="line">               2.时间戳请求和回答：请求某台主机或路由器回答当前的日期和时间</span><br></pre></td></tr></table></figure></li>
<li>路由选择协议：互联网采用的路由选择协议主要是自适应的、分布式路由选择协议<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">路由选择协议分为两大类：</span><br><span class="line">1. 内部网关协议IGP：RIP协议（路由信息协议）、OSPF协议（开放最短路径优先协议）、IGRP（内部网关路由协议）、EIGRP（增强内部网关路由协议）</span><br><span class="line">2. 外部网关协议EGP：BGP（边界网关协议）</span><br></pre></td></tr></table></figure></li>
<li>RIP协议：分布式的基于距离向量（跳数）的路由选择协议<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">距离（跳数）：路由器到直连网络的距离定义为1，到非直连网络的距离为经过的路由器数加1</span><br><span class="line">             最多只能包含15个路由器，距离为16时表示不可达，因此只适用小型网络</span><br><span class="line">特点：  </span><br><span class="line">1. 仅和相邻的路由器将换信息</span><br><span class="line">2. 交换当前路由器知道的全部信息，即自己现在的路由表</span><br><span class="line">3. 按固定的时间间隔交换路由信息</span><br><span class="line">距离向量算法：</span><br><span class="line">             1. 将从地址为X的相邻路由器交换得到的路由表的距离加1，下一跳地址改为X</span><br><span class="line">             2.  </span><br><span class="line">                 if 网络N 不在原路由表中</span><br><span class="line">                     添加该网络到路由表</span><br><span class="line">                 else(即路由表中存在该网络)</span><br><span class="line">                      if N的下一跳地址为X </span><br><span class="line">                           替换原路由项（即更新到最新版）</span><br><span class="line">                      else(即下一跳地址不是X)</span><br><span class="line">                          if 距离小于原表中的距离</span><br><span class="line">                             更新替换</span><br><span class="line">             3. 若三分钟没有收到相邻路由器的路由信息，则将该路由器设置为不可达，即将跳数设置为16</span><br><span class="line">RIP协议的报文：</span><br><span class="line">1. RIP2支持VLSM和CIDR（RIP1有类路由协议，RIP2无类路由协议，RIP1不支持VLSM）</span><br><span class="line">2. RIP协议使用用户数据包协议UDP进行传送（UDP端口为520）</span><br><span class="line">3. 报文由首部和路由部分构成：</span><br><span class="line">           首部四个字节：命令（报文的意义）、版本、必为0（保证四字节的对齐）</span><br><span class="line">           路由部分由若干个20字节路由信息组成：</span><br><span class="line">                路由信息：</span><br><span class="line">                     地址簇标识符：标志使用的地址协议，2字节</span><br><span class="line">                     路由标记：填入所在的自治系统号（ASN），2字节</span><br><span class="line">                     网络地址：四字节</span><br><span class="line">                     子网掩码：四字节</span><br><span class="line">                     下一跳路由器地址：四字节</span><br><span class="line">                     距离：1~16</span><br><span class="line">                注：一个RIP报文可有多个路由信息，最多为25个，RIP报文最大长度为：4字节首部 + 20 x 25(路由部分) &#x3D; 504</span><br><span class="line">                     </span><br></pre></td></tr></table></figure></li>
<li>OSPF协议：使用了Dijkstra提出的最短路径算法SPF<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">最主要特征：使用分布式的链路状态协议（PPP是基于距离向量的路由选择协议）</span><br><span class="line"></span><br><span class="line">特点：</span><br><span class="line">1. 使用洪泛法向本自治系统内的所有路由器发送消息：路由器通过所有输出端口向相邻的路由器发送消息，收到消息的路由器再发给与他相邻的路由器而不发给源路由器（RIP协议仅发给相邻路由器）</span><br><span class="line">2. 发送的消息是与本路由器相邻的所有路由器的链路状态：链路状态即本路由器和哪些路由器相邻和度量（即代价，表示费用、距离、时延、带宽等）（RIP发送的是自己的路由表）</span><br><span class="line">3. 只有当链路状态发生变化时才使用洪泛法发送消息（RIP是固定时间间隔发送）</span><br><span class="line"></span><br><span class="line">交换信息的结果：所有路由器最终都建立一个链路状态数据库即全网的拓扑结构图</span><br><span class="line"></span><br><span class="line">OSPF的五种分组类型：</span><br><span class="line">1. 问候分组：维持邻站可达性（每10秒交换一次问候分组来维持可达性，网络中大多数OSPF分组都是问候分组，40秒收不到邻站的问候记为不可达）</span><br><span class="line">2. 数据库描述分组：向邻站给出自己的链路状态数据库的摘要信息</span><br><span class="line">3. 链路状态请求分组：向对方请求发送某些链路状态项目的信息</span><br><span class="line">4. 链路状态更新分组：用洪泛法对全网更新链路</span><br><span class="line">5. 链路状态确认分组：对链路更新分组的确认</span><br><span class="line"></span><br><span class="line">OSPF分组：</span><br><span class="line">1. 直接用IP数据报传送（RIP是先封装在用户数据包UDP中，再进一步封装到IP数据报中）</span><br><span class="line">2. 分组构成：</span><br><span class="line">             版本：版本号，当前为2，8位</span><br><span class="line">             类型：五种分组类型的一种，8位</span><br><span class="line">             分组长度：整个分组的长度，单位为字节，16位</span><br><span class="line">             路由器标识符：发送该分组的路由器接口IP地址，32位</span><br><span class="line">             区域标识符：分组所属于的区域的标识符，32位</span><br><span class="line">             检验和：检测分组中的差错，16位</span><br><span class="line">             鉴别类型：两种，0（不用）、1（口令），16位</span><br><span class="line">             鉴别：鉴别类型为0则填入0，为1则填入八个字符的口令</span><br></pre></td></tr></table></figure></li>
<li>边界网关协议BGP：采用路径向量路由选择协议，力求找到一条能到达目的网络且比较好的路由而不是最佳路由<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">总结：</span><br><span class="line">RIP：采用分布式的距离向量协议</span><br><span class="line">OSPF：采用分布式的链路状态协议</span><br><span class="line">BGP：采用路径向量路由选择协议</span><br></pre></td></tr></table></figure></li>
<li>路由器：任务为转发分组，将收到的分组按照其目的地选择合适的端口站发给下一跳路由器（路由器的转发分组正是网路层的主要工作）</li>
<li>虚拟专用网VPN：使用专用地址<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">互联网上的所有路由器对目的地址是专用地址的数据报一律不进行转发</span><br><span class="line">专用地址块：</span><br><span class="line">10.0.0.0 &#x2F;8     : 10.0.0.0 ~ 10.255.255.255</span><br><span class="line">172.16.0.0 &#x2F;12  : 172.16.0.0 ~ 172.31.255.255</span><br><span class="line">192.168.0.0 &#x2F;16 : 192.168.0.0 ~ 192.168.255.255</span><br></pre></td></tr></table></figure></li>
<li>网络地址转换NAT：专用网要连接到互联网的路由器要安装NAT软件，装有NAT软件的NAT路由器至少有一个有效的外部全球IP地址，是用本地地址的主机要和外部通信时要在NAT路由器上将本地地址转为全球IP地址</li>
</ol>
<h3 id="运输层（传输层）"><a href="#运输层（传输层）" class="headerlink" title="运输层（传输层）"></a>运输层（传输层）</h3><ol>
<li>通信的真正端点不是主机而是主机中的进程</li>
<li>分用和复用功能：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">复用：发送方不同的应用进程都可以使用同一个运输层协议传送数据</span><br><span class="line">分用：接收方的运输层剥去报文的首部后能够把这些数据正确交付给目的应用进程</span><br></pre></td></tr></table></figure></li>
<li>网络层为主机之间提供逻辑通信，运输层为应用进程之间提供端到端的逻辑通信</li>
<li>运输层对报文进行差错检测，网络层中IP数据报中的检验和字段只检验首部是否出现差错</li>
<li>运输层的两个主要协议：传输控制协议TCP；用户数据报协议UDP；运输协议数据单元TPDU分别为TCP报文段和UDP用户数据报<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用TCP的上层协议：HTTP, SMTP, FTP, Telnet</span><br><span class="line">使用UDP的上层协议：DHCP, TFTP, VoIP, IPTV</span><br><span class="line">使用两者：DNS, SNMP</span><br></pre></td></tr></table></figure></li>
<li>运输层的端口：对应用进程进行标志，当运输层收到IP层交上来的运输层报文时就可以根据其首部的目的端口号把数据交付给应用层的目的应用进程<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">运输层用16位来标志一个端口，端口只具有本地意义，16位允许有65535个不同的端口号</span><br><span class="line"></span><br><span class="line">端口号的分类：</span><br><span class="line">1.服务器使用的端口号：</span><br><span class="line">         熟知端口号（系统端口号）：0~1023指派给了TCP&#x2F;IP的一些重要应用进程</span><br><span class="line">                                  FTP：21  ；TELNET：23 ；HTTP：80 ； HTTPS:443 ; SMTP：25 ； DNS：53</span><br><span class="line">         登记端口号：1024~49151，使用这类端口需在IAIA按手续登记，防止重复</span><br><span class="line">2.客户端使用的端口号：49152~65525，仅在客户进程运行时动态选择，因此又叫短暂端口号</span><br><span class="line">                    通信结束后可再分配给其他进程</span><br></pre></td></tr></table></figure></li>
<li>用户数据报协议UDP：<br><img src="https://s1.ax1x.com/2018/12/15/FaZdyR.jpg" alt="image"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">特点：</span><br><span class="line">1. UDP是无连接的</span><br><span class="line">2. UDP使用尽最大努力交付</span><br><span class="line">3. UDP是面向报文的：对进程交下来的报文添加首部后就交付给IP层（若报文太长在IP层就要分片，会降低IP层效率）</span><br><span class="line">4. UDP无拥塞控制</span><br><span class="line">5. UDP支持一对一、一对多、多对一和多对多的交互通信</span><br><span class="line">6. 首部开销小</span><br><span class="line"></span><br><span class="line">UDP报文：数据字段和首部字段（8字节，每个字段都是2字节）</span><br><span class="line">         源端口号；目的端口号；长度（UDP用户数据报的长度）；检验和（检测传输过程是否出错，有错则丢弃）</span><br></pre></td></tr></table></figure></li>
<li>TCP的连接：TCP连接的端点叫套接字，把端口号拼接到IP地址的后面即组成套接字（如：192.168.1.1:80）<code>每一条TCP连接唯一地被通信两端的两个套接字所确定</code></li>
<li>TCP可靠传输的工作原理：停止等待协议和自动重传请求协议（ARQ协议）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1.停止等待协议：每发送完一个分组就停止发送，等待对方的确认，收到确认后再发送下一个分组</span><br><span class="line">传输过程中的几种情况：</span><br><span class="line">                  1. 无差错情况：每次发送都能收到确认，双方你来我往</span><br><span class="line">                  2. 出现差错：分组在传输过程中出现差错</span><br><span class="line">                           接收方：丢弃分组，其他啥也不做</span><br><span class="line">                           发送方：在发送分组前会保留分组副本并设置超时计时器，</span><br><span class="line">                             若计时器到期未收到确认则重传分组，分组和确认分组都有编号便于判断问题分组</span><br><span class="line">                  3. “确认”丢失和“确认”迟到：接收方发送的确认分组丢失或迟到</span><br><span class="line">                           发送方：未收到确认，重传分组</span><br><span class="line">                           接收方：收到丢弃重复分组，并发送确认</span><br><span class="line">2.自动重传请求协议（ARQ）：重传的请求是自动进行的，接收方不需要请求发送方重传出错分组</span><br><span class="line">3.连续ARQ协议：对按时序到达的最后一个分组发送确认而不是逐个发送确认，表示到该分组为止的所有分组都已收到</span><br></pre></td></tr></table></figure></li>
<li>TCP报文段的首部格式：<br><img src="https://s1.ax1x.com/2018/12/15/FaZPsI.jpg" alt="image"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">前20个字节是固定的。</span><br><span class="line">源端口和目的端口: 各占16位，即2个字节</span><br><span class="line">序号(seq)：4字节，TCP是面向字节流的，传送的字节流中的每个字节都要按顺序编号，序号指的</span><br><span class="line">是本报文的数据的第一个字节的编号</span><br><span class="line">确认号(ack)：4字节，期望收到对方下一个报文段德第一个数据字节的编号</span><br><span class="line">数据偏移：指出报文段的数据起始处距报文段的起始处的距离，即首部长度</span><br><span class="line">保留：6位，未使用</span><br><span class="line">紧急URG：URG为1表示报文段有紧急数据要传送，优先传送</span><br><span class="line">确认ACK：ACK为1时确认号字段才有效，TCP在建立连接后所传送的报文段必须把ACK置1</span><br><span class="line">推送PSH：PSH置1接收方接收到后尽快交付到进程而不用等到缓存满了</span><br><span class="line">复位RST：RST为1表示连接出现问题，需释放链接重新建立连接</span><br><span class="line">同步SYN：建立连接时用来同步序号，SYN为1，ACK为0表示连接请求报文段</span><br><span class="line">终止FIN：用来释放一个连接</span><br><span class="line">窗口：2字节，表示发送方的接收窗口大小，窗口值作为接收方让发送方设置其发送窗口的依据（即允许对方发送的数据量）</span><br><span class="line">检验和：2字节，检验整个报文段，计算检验和时要在报文段前加上12字节的伪首部</span><br><span class="line">紧急指针：2字节，在紧急字段URG为1时才有效，指出报文段中紧急数据的字节数</span><br><span class="line">选项：长度可变，最长可达40字节</span><br></pre></td></tr></table></figure></li>
<li>TCP可靠传输的实现：以字节为单位的滑动窗口、超时重传时间的选择（大于加权平均往返时间RTTs）</li>
<li>TCP的流量控制：让发送方的发送速率不要太快，要让接收方来得及接收<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过滑动窗口实现，利用窗口号来调节发送方的窗口大小，也就调节了发送速率</span><br></pre></td></tr></table></figure></li>
<li>TCP的拥塞控制：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">拥塞：网络中某一资源的需求超过了该资源所能提供的可用部分而引起网络性能的变坏</span><br><span class="line">拥塞控制：防止过多的数据注入到网络中，使网络中的路由器和链路不致过载</span><br><span class="line">负载：单位时间输入给网络的分组数目</span><br><span class="line">吞吐量：单位时间从网络输出的分组数目</span><br><span class="line">超时：判断网络拥塞的依据</span><br><span class="line"></span><br><span class="line">TCP拥塞控制的方法：慢开始、拥塞避免、快重传、快恢复</span><br><span class="line">     维持一个拥塞窗口cwnd的状态量，使发送窗口等于拥塞窗口，设置一个慢开始门限ssthresh</span><br><span class="line">     慢开始算法：发送方每收到一个确认就将cwnd加1，即每经过一个传播伦次（也就是一个往返时间RTT）cwnd就加倍，到达门限开始执行拥塞避免</span><br><span class="line">     拥塞避免算法：每经过一个传播伦次cwnd加1</span><br><span class="line">     快重传算法：收到报文段立即回复确认，收到失序报文段即有报文段丢失则连续发送三个</span><br><span class="line">     对此报文段的确认，发送方收到三个重复确认则重传，避免因将丢失误判为超时</span><br><span class="line">     快恢复算法：ssthresh &#x3D; cwnd &#x2F; 2， cwnd &#x3D; ssthresh， 执行拥塞避免算法</span><br><span class="line">     即：   cwnd &lt; ssthresh : 慢开始算法，cwnd &#x3D; cwnd *2</span><br><span class="line">            cwnd &gt; ssthresh : 拥塞避免算法，cwnd &#x3D; cwnd + 1</span><br><span class="line">            发生超时：ssthresh &#x3D; cwnd &#x2F; 2, cwnd &#x3D; 1，执行慢开始算法</span><br><span class="line">            收到三个重复确认：立即重传，执行快恢复算法</span><br><span class="line"></span><br><span class="line">主动队列管理（AQM）：等到路由器的分组队列长度达到某个警惕值就主动丢弃到达的分组，而不是等到队列长度</span><br><span class="line">                已经达到最大值才开始丢弃分组</span><br></pre></td></tr></table></figure>
<img src="https://s1.ax1x.com/2018/12/15/FarQXj.jpg" alt="image"></li>
<li>TCP连接的建立（三次握手）<br><img src="https://s1.ax1x.com/2018/11/15/ivIfTs.png" alt="image"> <blockquote>
<p>SYN用于建立连接，ACK建立连接后置1</p>
</blockquote>
<h5 id="第一次握手：SYN-1，-ACK-0"><a href="#第一次握手：SYN-1，-ACK-0" class="headerlink" title="第一次握手：SYN = 1， ACK = 0"></a>第一次握手：SYN = 1， ACK = 0</h5><blockquote>
<p>客户A选择一个序列号x，使seq=x，发送给服务器B。不携带数据。</p>
</blockquote>
<h5 id="第二次握手：SYN-1，-ACK-1"><a href="#第二次握手：SYN-1，-ACK-1" class="headerlink" title="第二次握手：SYN = 1， ACK = 1"></a>第二次握手：SYN = 1， ACK = 1</h5><blockquote>
<p>服务器B使用ack对A的数据包确认，ack=x+1，表示已经收到了序列号为x的数据包准备接收序列号为x+1的数据包，同时服务器B告诉客户A自己的初始序列号，即seq=y。 不携带数据。</p>
</blockquote>
<h5 id="第三次握手：ACK-1"><a href="#第三次握手：ACK-1" class="headerlink" title="第三次握手：ACK = 1"></a>第三次握手：ACK = 1</h5><blockquote>
<p>客户A告诉服务器B收到了确认消息，并且指明此次消息的序列号为seq=x+1，而ack=y+1是表示客户A正准备接收服务器B序列号为y+1的数据包。</p>
</blockquote>
</li>
<li>TCP连接的释放<br><img src="https://s1.ax1x.com/2018/12/08/F8PiMd.png" alt="image"></li>
</ol>
<ul>
<li>A的应用进程先向其TCP发出连接释放报文段（FIN=1，序号seq=u），并停止再发送数据，主动关闭TCP连接，进入FIN-WAIT-1（终止等待1）状态，等待B的确认。</li>
<li>B收到连接释放报文段后即发出确认报文段，（ACK=1，确认号ack=u+1，序号seq=v），B进入CLOSE-WAIT（关闭等待）状态，此时的TCP处于半关闭状态，A到B的连接释放。</li>
<li>A收到B的确认后，进入FIN-WAIT-2（终止等待2）状态，等待B发出的连接释放报文段。</li>
<li>B没有要向A发出的数据，B发出连接释放报文段（FIN=1，ACK=1，序号seq=w，确认号ack=u+1），B进入LAST-ACK（最后确认）状态，等待A的确认。</li>
<li>A收到B的连接释放报文段后，对此发出确认报文段（ACK=1，seq=u+1，ack=w+1），A进入TIME-WAIT（时间等待）状态。此时TCP未释放掉，需要经过时间等待计时器设置的时间2MSL后，A才进入CLOSED状态。</li>
</ul>
<h3 id="数据封装的整个过程"><a href="#数据封装的整个过程" class="headerlink" title="数据封装的整个过程"></a>数据封装的整个过程</h3><p><img src="https://s1.ax1x.com/2018/12/15/FaDHl4.md.jpg" alt="image"></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='true'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%92%E8%81%94%E7%BD%91%E6%A6%82%E8%BF%B0%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">互联网概述：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">2.</span> <span class="toc-text">物理层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">数据链路层：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text">网络层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%BE%93%E5%B1%82%EF%BC%88%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">运输层（传输层）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9ASYN-1%EF%BC%8C-ACK-0"><span class="toc-number">5.0.1.</span> <span class="toc-text">第一次握手：SYN &#x3D; 1， ACK &#x3D; 0</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9ASYN-1%EF%BC%8C-ACK-1"><span class="toc-number">5.0.2.</span> <span class="toc-text">第二次握手：SYN &#x3D; 1， ACK &#x3D; 1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9AACK-1"><span class="toc-number">5.0.3.</span> <span class="toc-text">第三次握手：ACK &#x3D; 1</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B0%81%E8%A3%85%E7%9A%84%E6%95%B4%E4%B8%AA%E8%BF%87%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text">数据封装的整个过程</span></a></li></ol>	
        </div>
    
</div>


    </div>
</div>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




</html>
